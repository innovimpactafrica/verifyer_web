<div class="min-h-screen w-full bg-gradient-to-br from-[#EFF6FF] to-[#F0FDF4]">
    <div class="flex min-h-screen">
        <app-client-sidebar></app-client-sidebar>
        <div *ngIf="certificationDetails" class="flex-1 ml-20 p-4 md:max-xl:ml-64 md:py-6 xl:ml-72 xl:pl-6 2xl:pl-16 overflow-y-auto">
            <!-- Header -->
            <div class="mb-4">
                <!-- Back Button & Breadcrumb -->
                <div class="flex items-center gap-3">
                    <button (click)="goBack()"
                        class="inline-flex items-center justify-center p-5 rounded-lg bg-white hover:bg-gray-50">
                        <!-- Placeholder SVG Back Arrow -->
                        <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 7H1M1 7L7 1M1 7L7 13" stroke="#2B3674" stroke-width="1.5"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                    <div>
                        <h1 class="text-xl md:text-2xl font-bold text-[#172B4D]">Certification {{
                            certificationDetails.reference }} – {{ certificationDetails.nom }}</h1>
                        <div class="flex items-center gap-2 mt-1 text-xs text-[#868E96]">
                            <span>Pages</span>
                            <svg width="6" height="10" viewBox="0 0 6 10" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M0.634658 1.3869L1.34199 0.680238L5.19466 4.53157C5.25676 4.59328 5.30605 4.66667 5.33968 4.7475C5.37331 4.82833 5.39063 4.91502 5.39063 5.00257C5.39063 5.09012 5.37331 5.17681 5.33968 5.25764C5.30605 5.33847 5.25676 5.41186 5.19466 5.47357L1.34199 9.3269L0.635325 8.62024L4.25132 5.00357L0.634658 1.3869Z"
                                    fill="#333399" />
                            </svg>
                            <span>Mes certifications</span>
                            <svg width="6" height="10" viewBox="0 0 6 10" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M0.634658 1.3869L1.34199 0.680238L5.19466 4.53157C5.25676 4.59328 5.30605 4.66667 5.33968 4.7475C5.37331 4.82833 5.39063 4.91502 5.39063 5.00257C5.39063 5.09012 5.37331 5.17681 5.33968 5.25764C5.30605 5.33847 5.25676 5.41186 5.19466 5.47357L1.34199 9.3269L0.635325 8.62024L4.25132 5.00357L0.634658 1.3869Z"
                                    fill="#333399" />
                            </svg>
                            <span>Détail du rapport</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Column - 2/3 -->
                <div class="lg:col-span-2 space-y-4">
                    <!-- Property Info Card -->
                    <div class="bg-white rounded-xl border border-gray-100 p-5">
                        <div class="flex items-start justify-between">
                            <div class="flex items-center gap-4">
                                <div
                                    [class]="'w-12 h-12 rounded-lg flex items-center justify-center ' + getIconBgClass(certificationDetails.type)">
                                    <div [innerHTML]="getIconSvg(certificationDetails.type)"></div>
                                </div>
                                <div>
                                    <h2 class="text-xl font-medium text-[#172B4D]">{{ certificationDetails.nom }}</h2>
                                    <p class="text-sm text-[#8392AB]">{{ certificationDetails.type }}</p>
                                </div>
                            </div>
                            <span
                                [class]="'inline-flex items-center px-3 py-1.5 rounded-full text-xs ' + getStatutClass(certificationDetails.statut)">
                                {{ certificationDetails.statut }}
                            </span>
                        </div>

                        <!-- Score Quality -->
                        <div class="mt-4">
                            <div class="flex items-center justify-between gap-2 mb-2">
                                <span class="text-xs text-[#172B4D]">Score qualité</span>
                                <div class="flex-1 flex items-center gap-2">
                                    <div class="flex-1 h-2 bg-gray-200 rounded-full overflow-hidden">
                                        <div class="h-full bg-[#0D823B] rounded-full transition-all duration-300"
                                            [style.width.%]="certificationDetails.score">
                                        </div>
                                    </div>
                                    <span [class]="'text-sm font-semibold' + getScoreClass(certificationDetails.score)">
                                        {{ certificationDetails.score }} / 100 ({{ certificationDetails.scoreLabel }})
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mission Details Card -->
                    <div class="bg-white rounded-xl border border-gray-100 p-6">
                        <h3 class="text-base font-semibold text-[#172B4D] border-b border-[#F7FAFC] pb-3 mb-6">
                            Détails de la mission
                        </h3>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Column 1 -->
                            <div class="space-y-4">
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Référence</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.reference
                                        }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Adresse</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.adresse }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Agent</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.agent }}
                                    </div>
                                </div>
                            </div>

                            <!-- Column 2 -->
                            <div class="space-y-4">
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Type</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.type }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Zone</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.zone }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Validité</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.validite
                                        }}
                                    </div>
                                </div>
                            </div>

                            <!-- Column 3 -->
                            <div class="space-y-4">
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Client</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{ certificationDetails.client }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Facture</div>
                                    <div
                                        class="text-base font-medium text-[#274B9B] underline cursor-pointer hover:text-[#1a3570]">
                                        {{ certificationDetails.facture }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-[#8392AB] mb-1">Date soumise</div>
                                    <div class="text-base font-medium text-[#172B4D]">{{
                                        certificationDetails.dateSubmission }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Documents Card -->
                    <div class="bg-white rounded-xl border border-gray-100 p-6">
                        <h3 class="text-base font-semibold text-[#172B4D] border-b border-[#F7FAFC] pb-3 mb-6">
                            Documents associés
                        </h3>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div *ngFor="let doc of certificationDetails.documents"
                                class="flex items-center justify-between p-4 rounded-lg border border-gray-100 hover:border-[#0D823B] hover:bg-[#0D823B05] transition cursor-pointer"
                                (click)="downloadDocument(doc)">
                                <div class="flex items-center gap-3">
                                    <div
                                        [class]="'w-10 h-10 rounded-lg flex items-center justify-center ' + (doc.type === 'pdf' ? 'bg-red-50' : 'bg-blue-50')">
                                        <div [innerHTML]="getDocumentIconSvg(doc.type)"></div>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-[#172B4D]">{{ doc.nom }}</div>
                                        <div class="text-xs text-[#8392AB]">{{ doc.taille }}</div>
                                    </div>
                                </div>
                                <!-- Placeholder Download Icon -->
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M7 10.577L3.461 7.039L4.169 6.319L6.5 8.65V0H7.5V8.65L9.83 6.32L10.539 7.039L7 10.577ZM1.616 14C1.15533 14 0.771 13.846 0.463 13.538C0.155 13.23 0.000666667 12.8453 0 12.384V9.961H1V12.384C1 12.538 1.064 12.6793 1.192 12.808C1.32 12.9367 1.461 13.0007 1.615 13H12.385C12.5383 13 12.6793 12.936 12.808 12.808C12.9367 12.68 13.0007 12.5387 13 12.384V9.961H14V12.384C14 12.8447 13.846 13.229 13.538 13.537C13.23 13.845 12.8453 13.9993 12.384 14H1.616Z"
                                        fill="#8F9BBA" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column - 1/3 -->
                <div class="lg:col-span-1 space-y-4">
                    <!-- Historiques Card -->
                    <div class="bg-white rounded-xl border border-gray-100 p-6">
                        <h3 class="text-base font-semibold text-[#172B4D] mb-6">Historiques</h3>
                        <div class="relative">
                            <!-- Vertical dotted Line -->
                            <div class="absolute left-4 top-12 bottom-12 w-px border-l border-dotted border-[#CBD5E1]">
                            </div>

                            <div class="space-y-12">
                                <div *ngFor="let hist of certificationDetails.historiques; let last = last"
                                    class="flex items-start gap-3 relative">
                                    <div
                                        class="w-8 h-8 rounded-full border border-dotted border-[#CBD5E1] flex items-center justify-center flex-shrink-0 bg-white z-10">
                                        <div [innerHTML]="getHistoriqueIconSvg(hist.type)"></div>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm font-semibold text-[#172B4D]">{{ hist.label }}</p>
                                        <p class="text-xs text-[#868E96] mt-1">{{ hist.date }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- QR Code Card -->
                    <div class="bg-white rounded-xl border border-gray-100 p-6">
                        <h3 class="text-base font-semibold text-[#172B4D] border-b border-[#F7FAFC] pb-3 mb-6">
                            QR- Code Certificat
                        </h3>

                        <div class="flex flex-col items-center">
                            <!-- QR Code -->
                            <div class="bg-white p-3 rounded-xl mb-4">
                                <img src="qr.png" alt="QR Code" class="w-48 h-48 object-contain">
                            </div>

                            <!-- Description -->
                            <p class="text-xs text-[#6B7280] text-center mb-6">
                                Ce QR code permet de vérifier l'authenticité de votre certificat. Vous pouvez l'imprimer
                                ou le partager numériquement.
                            </p>

                            <!-- Download Button -->
                            <button
                                class="w-full py-3 px-4 rounded-lg text-white font-medium text-sm transition hover:opacity-90 bg-gradient-to-r from-[#0D823B] to-[#2ED573]">
                                Télécharger le certificat
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>