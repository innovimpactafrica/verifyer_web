import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ActivatedRoute, Router, RouterModule } from '@angular/router';
import { ClientSidebarComponent } from '../../client-sidebar/client-sidebar.component';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';

@Component({
    selector: 'app-detail-certification',
    standalone: true,
    imports: [CommonModule, RouterModule, ClientSidebarComponent],
    templateUrl: './detail-certification.component.html',
    styleUrl: './detail-certification.component.css'
})
export class DetailCertificationComponent implements OnInit {
    certificationId: string = '';
    certificationDetails: any = null;

    // Dictionnaire des icônes de types
    typeIcons: { [key: string]: string } = {
        'Immobilier': `<svg width="27" height="26" viewBox="0 0 27 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M25.9375 24.6879H0.937531M0.937531 10.9379L11.095 2.81287C11.7599 2.28098 12.5861 1.99121 13.4375 1.99121C14.289 1.99121 15.1151 2.28098 15.78 2.81287L25.9375 10.9379" stroke="#0D823B" stroke-width="1.875" stroke-linecap="round"/>
          <path opacity="0.5" d="M17.8125 4.0625V1.5625C17.8125 1.39674 17.8784 1.23777 17.9956 1.12056C18.1128 1.00335 18.2718 0.9375 18.4375 0.9375H21.5625C21.7283 0.9375 21.8873 1.00335 22.0045 1.12056C22.1217 1.23777 22.1875 1.39674 22.1875 1.5625V7.8125" stroke="#0D823B" stroke-width="1.875" stroke-linecap="round"/>
          <path d="M3.43753 24.6875V9.0625M23.4375 24.6875V9.0625" stroke="#0D823B" stroke-width="1.875" stroke-linecap="round"/>
          <path opacity="0.5" d="M17.1875 24.6875V18.4375C17.1875 16.67 17.1875 15.7862 16.6375 15.2375C16.09 14.6875 15.2063 14.6875 13.4375 14.6875C11.6688 14.6875 10.7863 14.6875 10.2375 15.2375C9.68753 15.785 9.68753 16.6688 9.68753 18.4375V24.6875M15.9375 9.0625C15.9375 9.72554 15.6741 10.3614 15.2053 10.8303C14.7365 11.2991 14.1006 11.5625 13.4375 11.5625C12.7745 11.5625 12.1386 11.2991 11.6698 10.8303C11.2009 10.3614 10.9375 9.72554 10.9375 9.0625C10.9375 8.39946 11.2009 7.76357 11.6698 7.29473C12.1386 6.82589 12.7745 6.5625 13.4375 6.5625C14.1006 6.5625 14.7365 6.82589 15.2053 7.29473C15.6741 7.76357 15.9375 8.39946 15.9375 9.0625Z" stroke="#0D823B" stroke-width="1.875"/>
        </svg>`,
        'Restaurant': `<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_93_4230)">
            <path d="M1.79655 1.49194L13.31 13.0054C13.5285 13.2239 13.6512 13.5202 13.6512 13.8291C13.6512 14.1381 13.5285 14.4344 13.31 14.6529C13.0915 14.8713 12.7952 14.9939 12.4862 14.9939C12.1773 14.9939 11.881 14.8713 11.6625 14.6529L8.84999 11.7919C8.66594 11.605 8.56268 11.3533 8.56249 11.091V10.9182C8.56252 10.7857 8.53623 10.6546 8.48516 10.5324C8.43409 10.4102 8.35925 10.2994 8.26499 10.2063L7.90187 9.87101C7.7786 9.75726 7.62869 9.67635 7.46596 9.63572C7.30323 9.59509 7.13288 9.59605 6.97062 9.63851C6.71473 9.70529 6.44583 9.704 6.1906 9.63476C5.93537 9.56553 5.70268 9.43076 5.51562 9.24382L2.84593 6.57382C1.26218 4.99007 0.679367 2.59851 1.79655 1.49194Z" stroke="#6F42C1" stroke-linejoin="round"/>
            <path d="M12.5 1L10.0859 3.41406C9.90018 3.59979 9.75282 3.82029 9.65229 4.06297C9.55175 4.30565 9.50001 4.56576 9.50001 4.82844V5.29281C9.50002 5.35851 9.48708 5.42357 9.46193 5.48427C9.43678 5.54497 9.39992 5.60012 9.35345 5.64656L9.00001 6M10 7L10.3534 6.64656C10.3999 6.60009 10.455 6.56322 10.5157 6.53808C10.5764 6.51293 10.6415 6.49999 10.7072 6.5H11.1716C11.4343 6.5 11.6944 6.44826 11.937 6.34772C12.1797 6.24718 12.4002 6.09983 12.5859 5.91406L15 3.5M13.75 2.25L11.25 4.75M6.25001 11.5L3.13376 14.6337C2.89935 14.8681 2.58146 14.9997 2.25001 14.9997C1.91855 14.9997 1.60067 14.8681 1.36626 14.6337C1.13192 14.3993 1.00027 14.0815 1.00027 13.75C1.00027 13.4185 1.13192 13.1007 1.36626 12.8663L4.00001 10.25" stroke="#6F42C1" stroke-linecap="round" stroke-linejoin="round"/>
          </g>
          <defs><clipPath id="clip0_93_4230"><rect width="16" height="16" fill="white"/></clipPath></defs>
        </svg>`,
        'Hôtel': `<svg width="22" height="15" viewBox="0 0 22 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 15V0H2V10H10V2H18C19.1 2 20.0417 2.39167 20.825 3.175C21.6083 3.95833 22 4.9 22 6V15H20V12H2V15H0ZM6 9C5.16667 9 4.45833 8.70833 3.875 8.125C3.29167 7.54167 3 6.83333 3 6C3 5.16667 3.29167 4.45833 3.875 3.875C4.45833 3.29167 5.16667 3 6 3C6.83333 3 7.54167 3.29167 8.125 3.875C8.70833 4.45833 9 5.16667 9 6C9 6.83333 8.70833 7.54167 8.125 8.125C7.54167 8.70833 6.83333 9 6 9ZM12 10H20V6C20 5.45 19.8043 4.97933 19.413 4.588C19.0217 4.19667 18.5507 4.00067 18 4H12V10ZM6 7C6.28333 7 6.521 6.904 6.713 6.712C6.905 6.52 7.00067 6.28267 7 6C6.99933 5.71733 6.90333 5.48 6.712 5.288C6.52067 5.096 6.28333 5 6 5C5.71667 5 5.47933 5.096 5.288 5.288C5.09667 5.48 5.00067 5.71733 5 6C4.99933 6.28267 5.09533 6.52033 5.288 6.713C5.48067 6.90567 5.718 7.00133 6 7Z" fill="#FD7E14"/>
        </svg>`,
        'Artisan': `<svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.737625 8.57304e-05C0.725082 -0.000103941 0.712537 2.11305e-05 0.7 0.000460763C0.5535 0.00536701 0.452687 0.0546482 0.383969 0.123367C0.292344 0.214992 0.235219 0.363648 0.271844 0.601648C0.308531 0.839648 0.449438 1.15646 0.749094 1.50605C2.87078 3.98137 4.90331 6.3673 6.48981 8.13012C6.87334 8.55624 7.23022 8.94509 7.55622 9.29056C7.93419 8.29362 8.63653 7.59855 9.52191 7.26821C9.18362 6.94949 8.80516 6.60218 8.39075 6.22921C6.628 4.64271 4.242 2.61012 1.76672 0.488429C1.41716 0.188742 1.10031 0.047867 0.862313 0.0111795C0.821044 0.00470782 0.779388 0.00100159 0.737625 8.57304e-05ZM12.4598 0.0326795C12.4502 0.0325754 12.441 0.0328149 12.4324 0.0333982C12.3633 0.037992 12.3281 0.0538358 12.2894 0.092492L11.4276 0.954367L13.1512 2.67793L14.013 1.81605C14.0517 1.77743 14.0675 1.74224 14.0721 1.67312C14.0768 1.60405 14.0605 1.5033 14.0157 1.38674C13.926 1.15362 13.7258 0.865898 13.4827 0.622836C13.2397 0.379773 12.9519 0.179555 12.7188 0.089867C12.6168 0.0506483 12.527 0.0333045 12.4598 0.0326795H12.4598ZM11.0298 1.35205L10.7205 1.66146L11.0298 1.97077L11.4276 2.36855L11.7369 2.67787L12.1347 3.07565L12.444 3.38502L12.7534 3.07565L11.0298 1.35205ZM10.3228 2.05918L7.59184 4.79012L7.91894 5.08174L10.6321 2.36855L10.3228 2.05918ZM11.0298 2.76634L8.33947 5.45665L8.66662 5.74824L11.3392 3.07565L11.0298 2.76634ZM11.737 3.47334L9.08716 6.12318L9.41431 6.4148L12.0464 3.78274L11.7371 3.47337H11.737V3.47334ZM5.05397 7.32802L1.30719 11.0749L1.6165 11.3842L5.34594 7.65474L5.05397 7.32802ZM9.98084 7.70762C9.02894 7.94596 8.31709 8.61962 7.99309 9.74568C8.16972 9.92646 8.33547 10.0921 8.48622 10.2365C8.72309 10.4635 8.92672 10.643 9.08653 10.7664C9.14206 10.2281 9.40044 9.73324 9.76294 9.36984C10.0942 9.03771 10.5284 8.80715 10.9856 8.77321C10.8647 8.62209 10.7 8.43727 10.4972 8.22562C10.346 8.0679 10.1717 7.89365 9.98084 7.70762ZM5.72137 8.07474L2.01422 11.7818L2.32359 12.0913L6.01344 8.40146L5.72137 8.07474ZM6.38891 8.82143L2.72137 12.489L3.03063 12.7983L6.68094 9.14815L6.38891 8.82143ZM11.0856 9.33102C10.7607 9.3353 10.4315 9.49602 10.1611 9.76712C9.80059 10.1285 9.57756 10.6687 9.65278 11.1953C9.81947 12.3622 10.395 13.2518 11.1984 13.7339C11.9087 14.16 12.8063 14.2761 13.8123 13.9521C13.0553 13.8268 12.3599 12.9926 12.3061 12.3693C12.6383 12.7698 13.0542 13.1364 13.5069 13.3615C13.1981 12.656 13.2194 11.9411 13.1604 11.3515C13.1182 10.9289 13.0388 10.5708 12.8049 10.2526C12.5709 9.93452 12.1667 9.6339 11.4067 9.38059C11.3032 9.3461 11.1947 9.32934 11.0856 9.33102ZM1.01213 11.5753L1.01203 11.5753L1.01209 11.5754L1.01213 11.5753ZM1.01209 11.5754L0.633438 12.5223L1.58319 13.4721L2.53022 13.0934L2.32366 12.8867L1.92578 12.489L1.61647 12.1797L1.21866 11.782L1.01209 11.5754ZM0.406 13.0906L0 14.1054L1.01494 13.6994L0.406 13.0906Z" fill="#274B9B"/>
        </svg>`
    };

    // Dictionnaire des icônes de documents
    documentIcons: { [key: string]: string } = {
        'pdf': `<svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 7H14.5L9 1.5V7ZM2 0H10L16 6V18C16 18.5304 15.7893 19.0391 15.4142 19.4142C15.0391 19.7893 14.5304 20 14 20H2C1.46957 20 0.960859 19.7893 0.585786 19.4142C0.210714 19.0391 0 18.5304 0 18V2C0 1.46957 0.210714 0.960859 0.585786 0.585786C0.960859 0.210714 1.46957 0 2 0ZM6.93 10.44C7.34 11.34 7.86 12.08 8.46 12.59L8.87 12.91C8 13.07 6.8 13.35 5.53 13.84L5.42 13.88L5.92 12.84C6.37 11.97 6.7 11.18 6.93 10.44ZM13.41 14.25C13.59 14.07 13.68 13.84 13.69 13.59C13.72 13.39 13.67 13.2 13.57 13.04C13.28 12.57 12.53 12.35 11.29 12.35L10 12.42L9.13 11.84C8.5 11.32 7.93 10.41 7.53 9.28L7.57 9.14C7.9 7.81 8.21 6.2 7.55 5.54C7.46927 5.46161 7.37378 5.40003 7.26907 5.35883C7.16435 5.31763 7.0525 5.29764 6.94 5.3H6.7C6.33 5.3 6 5.69 5.91 6.07C5.54 7.4 5.76 8.13 6.13 9.34V9.35C5.88 10.23 5.56 11.25 5.05 12.28L4.09 14.08L3.2 14.57C2 15.32 1.43 16.16 1.32 16.69C1.28 16.88 1.3 17.05 1.37 17.23L1.4 17.28L1.88 17.59L2.32 17.7C3.13 17.7 4.05 16.75 5.29 14.63L5.47 14.56C6.5 14.23 7.78 14 9.5 13.81C10.53 14.32 11.74 14.55 12.5 14.55C12.94 14.55 13.24 14.44 13.41 14.25ZM13 13.54L13.09 13.65C13.08 13.75 13.05 13.76 13 13.78H12.96L12.77 13.8C12.31 13.8 11.6 13.61 10.87 13.29C10.96 13.19 11 13.19 11.1 13.19C12.5 13.19 12.9 13.44 13 13.54ZM3.83 15C3.18 16.19 2.59 16.85 2.14 17C2.19 16.62 2.64 15.96 3.35 15.31L3.83 15ZM6.85 8.09C6.62 7.19 6.61 6.46 6.78 6.04L6.85 5.92L7 5.97C7.17 6.21 7.19 6.53 7.09 7.07L7.06 7.23L6.9 8.05L6.85 8.09Z" fill="#EF5350" />
        </svg>`,
        'excel': `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14.6855 11.5123L6.38379 10.0498V20.8566C6.38369 20.974 6.40678 21.0903 6.45173 21.1989C6.49667 21.3074 6.5626 21.4059 6.64573 21.4889C6.72885 21.5719 6.82754 21.6377 6.93613 21.6824C7.04472 21.7272 7.16108 21.7501 7.27854 21.7498H21.6035C21.7211 21.7503 21.8376 21.7276 21.9464 21.6829C22.0552 21.6382 22.154 21.5725 22.2373 21.4895C22.3206 21.4065 22.3867 21.3078 22.4317 21.1992C22.4768 21.0906 22.4999 20.9741 22.4998 20.8566V16.8748L14.6855 11.5123Z" fill="#185C37" />
            <path d="M14.6855 2.25H7.27854C7.16108 2.24971 7.04472 2.2726 6.93613 2.31736C6.82754 2.36213 6.72885 2.42789 6.64573 2.51088C6.5626 2.59386 6.49667 2.69244 6.45173 2.80096C6.40678 2.90947 6.38369 3.0258 6.38379 3.14325V7.125L14.6855 12L19.0813 13.4625L22.4998 12V7.125L14.6855 2.25Z" fill="#21A366" />
            <path d="M6.38379 7.125H14.6855V12H6.38379V7.125Z" fill="#107C41" />
            <path opacity="0.1" d="M12.3253 6.15039H6.38379V18.3379H12.3253C12.562 18.3367 12.7888 18.2423 12.9564 18.0751C13.124 17.9079 13.219 17.6814 13.2208 17.4446V7.04364C13.219 6.80689 13.124 6.58038 12.9564 6.41318C12.7888 6.24598 12.562 6.15157 12.3253 6.15039Z" fill="black" />
            <path opacity="0.2" d="M11.837 6.6377H6.38379V18.8252H11.837C12.0738 18.824 12.3005 18.7296 12.4682 18.5624C12.6358 18.3952 12.7308 18.1687 12.7325 17.9319V7.53095C12.7308 7.2942 12.6358 7.06769 12.4682 6.90049C12.3005 6.73329 12.0738 6.63887 11.837 6.6377Z" fill="black" />
            <path opacity="0.2" d="M11.837 6.6377H6.38379V17.8502H11.837C12.0738 17.849 12.3005 17.7546 12.4682 17.5874C12.6358 17.4202 12.7308 17.1937 12.7325 16.9569V7.53095C12.7308 7.2942 12.6358 7.06769 12.4682 6.90049C12.3005 6.73329 12.0738 6.63887 11.837 6.6377Z" fill="black" />
            <path opacity="0.2" d="M11.3488 6.6377H6.38379V17.8502H11.3488C11.5855 17.849 11.8123 17.7546 11.9799 17.5874C12.1475 17.4202 12.2425 17.1937 12.2443 16.9569V7.53095C12.2425 7.2942 12.1475 7.06769 11.9799 6.90049C11.8123 6.73329 11.5855 6.63887 11.3488 6.6377Z" fill="black" />
            <path d="M2.3955 6.6377H11.349C11.5862 6.6375 11.8137 6.73148 11.9816 6.89897C12.1496 7.06647 12.2441 7.29378 12.2445 7.53095V16.4695C12.2441 16.7066 12.1496 16.9339 11.9816 17.1014C11.8137 17.2689 11.5862 17.3629 11.349 17.3627H2.3955C2.27798 17.3631 2.16154 17.3403 2.05286 17.2956C1.94418 17.2508 1.84541 17.1851 1.7622 17.1021C1.679 17.0191 1.613 16.9205 1.56801 16.8119C1.52301 16.7034 1.4999 16.587 1.5 16.4695V7.53095C1.4999 7.41343 1.52301 7.29705 1.56801 7.18848C1.613 7.07991 1.679 6.9813 1.7622 6.89831C1.84541 6.81531 1.94418 6.74957 2.05286 6.70485C2.16154 6.66012 2.27798 6.63731 2.3955 6.6377Z" fill="url(#paint0_linear_93_4716)" />
            <path d="M4.27515 14.9047L6.1584 11.9917L4.4334 9.09521H5.81865L6.7599 10.95C6.8469 11.1255 6.9099 11.256 6.9384 11.343H6.95115C7.01265 11.2025 7.07765 11.066 7.14615 10.9335L8.15265 9.09821H9.42765L7.6584 11.9782L9.47265 14.907H8.1159L7.0284 12.8737C6.97805 12.7862 6.93514 12.6946 6.90015 12.6H6.88215C6.85036 12.6922 6.80808 12.7806 6.75615 12.8632L5.6364 14.9047H4.27515Z" fill="white" />
            <path d="M21.6045 2.25001H14.6858V7.125H22.5V3.14325C22.5001 3.02573 22.477 2.90935 22.432 2.80079C22.387 2.69222 22.321 2.59361 22.2378 2.51061C22.1546 2.42762 22.0559 2.36187 21.9472 2.31715C21.8385 2.27243 21.7221 2.24961 21.6045 2.25001Z" fill="#33C481" />
            <path d="M14.6858 12H22.5V16.875H14.6858V12Z" fill="#107C41" />
            <defs>
                <linearGradient id="paint0_linear_93_4716" x1="3.3705" y1="5.9357" x2="10.374" y2="18.0647" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#18884F" />
                    <stop offset="0.5" stop-color="#117E43" />
                    <stop offset="1" stop-color="#0B6631" />
                </linearGradient>
            </defs>
        </svg>`
    };

    // Dictionnaire des icônes d'historique
    historiqueIcons: { [key: string]: string } = {
        'status': `<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 9.99C20 4.475 15.52 0 10 0C4.48 0 0 4.475 0 9.99C0 13.0275 1.38 15.765 3.54 17.6025C3.56 17.6225 3.58 17.6225 3.58 17.6425C3.76 17.7825 3.94 17.9225 4.14 18.0625C4.24 18.1225 4.32 18.2013 4.42 18.2812C6.07325 19.4003 8.02362 19.9989 10.02 20C12.0164 19.9989 13.9667 19.4003 15.62 18.2812C15.72 18.2213 15.8 18.1425 15.9 18.0812C16.08 17.9425 16.28 17.8025 16.46 17.6625C16.48 17.6425 16.5 17.6425 16.5 17.6225C18.62 15.7637 20 13.0275 20 9.99ZM10 18.7412C8.12 18.7412 6.4 18.1413 4.98 17.1425C5 16.9825 5.04 16.8237 5.08 16.6637C5.19957 16.2303 5.37433 15.8139 5.6 15.425C5.82 15.045 6.08 14.705 6.4 14.405C6.7 14.105 7.06 13.8263 7.42 13.6063C7.8 13.3863 8.2 13.2262 8.64 13.1062C9.08357 12.9874 9.5408 12.9274 10 12.9275C11.3634 12.9172 12.6769 13.4402 13.66 14.385C14.12 14.845 14.48 15.3846 14.74 16.0037C14.88 16.3638 14.98 16.7433 15.04 17.1425C13.564 18.1802 11.8043 18.7384 10 18.7412ZM6.94 9.49125C6.76414 9.08766 6.67554 8.65147 6.68 8.21125C6.68 7.7725 6.76 7.3325 6.94 6.9325C7.12 6.5325 7.36 6.17375 7.66 5.87375C7.96 5.57375 8.32 5.335 8.72 5.155C9.12 4.975 9.56 4.895 10 4.895C10.46 4.895 10.88 4.975 11.28 5.155C11.68 5.335 12.04 5.575 12.34 5.87375C12.64 6.17375 12.88 6.53375 13.06 6.9325C13.24 7.3325 13.32 7.7725 13.32 8.21125C13.32 8.67125 13.24 9.09125 13.06 9.49C12.8873 9.88463 12.6432 10.244 12.34 10.55C12.0339 10.8527 11.6745 11.0964 11.28 11.2688C10.4534 11.6077 9.5266 11.6077 8.7 11.2688C8.30547 11.0964 7.94612 10.8527 7.64 10.55C7.33656 10.2483 7.0983 9.88878 6.94 9.49125ZM16.22 16.1238C16.22 16.0837 16.2 16.0638 16.2 16.0238C16.0037 15.3979 15.7137 14.8053 15.34 14.2663C14.966 13.7232 14.5067 13.2441 13.98 12.8475C13.5776 12.5447 13.1413 12.2896 12.68 12.0875C12.8889 11.9478 13.0832 11.7874 13.26 11.6087C13.5582 11.3144 13.82 10.9854 14.04 10.6287C14.4845 9.90167 14.7133 9.06332 14.7 8.21125C14.7065 7.58061 14.584 6.9553 14.34 6.37375C14.0994 5.81331 13.7531 5.30447 13.32 4.875C12.8865 4.45131 12.3778 4.11218 11.82 3.875C11.2376 3.63107 10.6114 3.50898 9.98 3.51625C9.34852 3.50937 8.72232 3.63189 8.14 3.87625C7.57605 4.11054 7.0657 4.45716 6.64 4.895C6.2141 5.32621 5.87466 5.83494 5.64 6.39375C5.39597 6.9753 5.27346 7.60061 5.28 8.23125C5.28 8.67125 5.34 9.09083 5.46 9.49C5.58 9.91 5.74 10.29 5.96 10.6488C6.16 11.0087 6.44 11.3288 6.74 11.6288C6.92 11.8088 7.12 11.9683 7.34 12.1075C6.87662 12.3138 6.44008 12.5757 6.04 12.8875C5.52 13.2875 5.06 13.7662 4.68 14.2863C4.30284 14.8233 4.01262 15.4164 3.82 16.0438C3.8 16.0837 3.8 16.1238 3.8 16.1437C2.22 14.545 1.24 12.3875 1.24 9.99C1.24 5.175 5.18 1.23875 10 1.23875C14.82 1.23875 18.76 5.175 18.76 9.99C18.7574 12.2899 17.8441 14.4953 16.22 16.1238Z" fill="#64748B" />
        </svg>`,
        'payment': `<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_93_4513)">
                <path d="M10 20C4.47688 20 0 15.5231 0 10C0 4.47688 4.47688 0 10 0C15.5231 0 20 4.47688 20 10C20 12.6522 18.9464 15.1957 17.0711 17.0711C15.1957 18.9464 12.6522 20 10 20ZM10 1.25C5.1675 1.25 1.25 5.1675 1.25 10C1.25 14.8325 5.1675 18.75 10 18.75C14.8325 18.75 18.75 14.8325 18.75 10C18.75 7.67936 17.8281 5.45376 16.1872 3.81282C14.5462 2.17187 12.3206 1.25 10 1.25Z" fill="#64748B" />
                <path d="M14.375 9.375H10.625V5.625H9.375V9.375H5.625V10.625H9.375V14.375H10.625V10.625H14.375V9.375Z" fill="#64748B" />
            </g>
            <defs>
                <clipPath id="clip0_93_4513">
                    <rect width="20" height="20" fill="white" />
                </clipPath>
            </defs>
        </svg>`
    };

    // Données simulées des certifications (même structure que mes-certifications)
    private certifications = [
        {
            id: 'CERT-006',
            reference: 'CERT-006',
            nom: 'Appartement A',
            type: 'Immobilier',
            statut: 'Valide',
            score: 92,
            scoreLabel: 'Excellent',
            client: 'Aminata Sow',
            adresse: 'Sicap, Rue 12',
            zone: 'Dakar',
            facture: 'FAC-2025-001',
            agent: 'Ibrahima Ndiaye',
            dureeValidite: '6 mois',
            dateEmission: '15/05/2023',
            dateExpiration: '15/05/2024',
            validite: '15/05/2023 - 15/05/2024',
            dateSubmission: '2023-05-10',
            historiques: [
                {
                    type: 'status',
                    label: 'Statut mis à "Valide"',
                    date: '15/05/2023 10:30'
                },
                {
                    type: 'payment',
                    label: 'Paiement reçu',
                    date: '10/05/2023 14:20'
                },
                {
                    type: 'status',
                    label: 'Demande soumise',
                    date: '05/05/2023 09:15'
                }
            ],
            documents: [
                {
                    nom: 'Certificat de conformité',
                    taille: '209 ko',
                    type: 'pdf'
                },
                {
                    nom: 'Rapport technique',
                    taille: '902 ko',
                    type: 'excel'
                }
            ]
        },
        {
            id: 'CERT-005',
            reference: 'CERT-005',
            nom: 'Villa A',
            type: 'Immobilier',
            statut: 'Valide',
            score: 88,
            scoreLabel: 'Excellent',
            client: 'Moussa Diop',
            adresse: 'Almadies, Dakar',
            zone: 'Dakar',
            facture: 'FAC-2024-892',
            agent: 'Fatou Sall',
            dureeValidite: '6 mois',
            dateEmission: '10/03/2023',
            dateExpiration: '10/03/2024',
            validite: '10/03/2023 - 10/03/2024',
            dateSubmission: '2023-03-05',
            historiques: [
                {
                    type: 'status',
                    label: 'Statut mis à "Valide"',
                    date: '10/03/2023 11:45'
                },
                {
                    type: 'payment',
                    label: 'Paiement reçu',
                    date: '08/03/2023 16:30'
                },
                {
                    type: 'status',
                    label: 'Demande soumise',
                    date: '05/03/2023 08:00'
                }
            ],
            documents: [
                {
                    nom: 'Certificat de conformité',
                    taille: '209 ko',
                    type: 'pdf'
                },
                {
                    nom: 'Rapport technique',
                    taille: '902 ko',
                    type: 'excel'
                }
            ]
        },
        {
            id: 'CERT-003',
            reference: 'CERT-003',
            nom: 'Restaurant Le Saloum',
            type: 'Restaurant',
            statut: 'En renouvellement',
            score: 84,
            scoreLabel: 'Bien',
            client: 'Cheikh Sy',
            adresse: 'Plateau, Dakar',
            zone: 'Dakar',
            facture: 'FAC-2024-654',
            agent: 'Aminata Ba',
            dureeValidite: '6 mois',
            dateEmission: '05/12/2022',
            dateExpiration: '05/12/2023',
            validite: '05/12/2022 - 05/12/2023',
            dateSubmission: '2022-12-01',
            historiques: [
                {
                    type: 'status',
                    label: 'Demande de renouvellement initiée',
                    date: '05/11/2023 14:20'
                },
                {
                    type: 'status',
                    label: 'Statut mis à "Valide"',
                    date: '05/12/2022 09:15'
                },
                {
                    type: 'payment',
                    label: 'Paiement reçu',
                    date: '03/12/2022 10:45'
                }
            ],
            documents: [
                {
                    nom: 'Certificat de conformité',
                    taille: '209 ko',
                    type: 'pdf'
                },
                {
                    nom: 'Rapport technique',
                    taille: '902 ko',
                    type: 'excel'
                }
            ]
        },
        {
            id: 'CERT-002',
            reference: 'CERT-002',
            nom: 'Hôtel du Parc',
            type: 'Hôtel',
            statut: 'En renouvellement',
            score: 90,
            scoreLabel: 'Excellent',
            client: 'Ibrahima Ndiaye',
            adresse: 'Point E, Dakar',
            zone: 'Dakar',
            facture: 'FAC-2023-321',
            agent: 'Ousmane Fall',
            dureeValidite: '6 mois',
            dateEmission: '20/10/2022',
            dateExpiration: '20/10/2023',
            validite: '20/10/2022 - 20/10/2023',
            dateSubmission: '2022-10-15',
            historiques: [
                {
                    type: 'status',
                    label: 'Demande de renouvellement initiée',
                    date: '20/09/2023 14:20'
                },
                {
                    type: 'status',
                    label: 'Statut mis à "Valide"',
                    date: '20/10/2022 13:30'
                },
                {
                    type: 'payment',
                    label: 'Paiement reçu',
                    date: '18/10/2022 11:20'
                }
            ],
            documents: [
                {
                    nom: 'Certificat de conformité',
                    taille: '209 ko',
                    type: 'pdf'
                },
                {
                    nom: 'Rapport technique',
                    taille: '902 ko',
                    type: 'excel'
                }
            ]
        },
        {
            id: 'CERT-001',
            reference: 'CERT-001',
            nom: 'Menuiserie Ndiambour',
            type: 'Artisan',
            statut: 'Expiré',
            score: 78,
            scoreLabel: 'Bien',
            client: 'Aïssatou Diallo',
            adresse: 'Thiès',
            zone: 'Thiès',
            facture: 'FAC-2023-198',
            agent: 'Mamadou Sarr',
            dureeValidite: '6 mois',
            dateEmission: '15/08/2022',
            dateExpiration: '15/08/2023',
            validite: '15/08/2022 - 15/08/2023',
            dateSubmission: '2022-08-10',
            historiques: [
                {
                    type: 'status',
                    label: 'Certificat expiré',
                    date: '15/08/2023 00:00'
                },
                {
                    type: 'status',
                    label: 'Statut mis à "Valide"',
                    date: '15/08/2022 15:45'
                },
                {
                    type: 'payment',
                    label: 'Paiement reçu',
                    date: '12/08/2022 09:30'
                }
            ],
            documents: [
                {
                    nom: 'Certificat de conformité',
                    taille: '209 ko',
                    type: 'pdf'
                },
                {
                    nom: 'Rapport technique',
                    taille: '902 ko',
                    type: 'excel'
                }
            ]
        }
    ];

    constructor(
        private route: ActivatedRoute,
        private router: Router,
        private sanitizer: DomSanitizer
    ) { }

    ngOnInit(): void {
        // Récupérer l'ID depuis l'URL
        this.route.paramMap.subscribe(params => {
            this.certificationId = params.get('id') || '';
            this.loadCertificationDetails();
        });
    }

    loadCertificationDetails(): void {
        // Charger les détails de la certification selon l'ID
        this.certificationDetails = this.certifications.find(c => c.id === this.certificationId);

        if (!this.certificationDetails) {
            console.warn(`Certification ${this.certificationId} introuvable`);
        }
    }

    getStatutClass(statut: string): string {
        switch (statut) {
            case 'Valide':
                return 'bg-[#0D823B0F] text-[#0D823B]';
            case 'En renouvellement':
                return 'bg-[#D6AB170F] text-[#D6AB17]';
            case 'Expiré':
                return 'bg-[#F543510F] text-[#F54351]';
            default:
                return 'bg-gray-100 text-gray-600';
        }
    }

    goBack(): void {
        this.router.navigate(['/mes-certifications']);
    }

    getIconBgClass(type: string): string {
        switch (type) {
            case 'Immeuble':
            case 'Immobilier':
                return 'bg-[#0D823B0D]';
            case 'Restaurant':
                return 'bg-[#6F42C10F]';
            case 'Hôtel':
                return 'bg-[#FD7E140F]';
            case 'Artisan':
                return 'bg-[#274B9B14]';
            default:
                return 'bg-gray-100';
        }
    }

    getIconSvg(type: string): SafeHtml {
        return this.sanitizer.bypassSecurityTrustHtml(this.typeIcons[type] || '');
    }

    getDocumentIconSvg(type: string): SafeHtml {
        return this.sanitizer.bypassSecurityTrustHtml(this.documentIcons[type] || '');
    }

    getHistoriqueIconSvg(type: string): SafeHtml {
        return this.sanitizer.bypassSecurityTrustHtml(this.historiqueIcons[type] || '');
    }

    getScoreClass(score: number): string {
        if (score >= 85) return 'text-[#0D823B]'; // Excellent (90, 92, 88)
        if (score >= 80) return 'text-[#0D823B]'; // Bien (84)
        if (score >= 70) return 'text-[#D6AB17]'; // Moyen (78)
        return 'text-red-500';
    }

    downloadDocument(doc: any): void {
        console.log('Téléchargement:', doc);
        // TODO: Implement download logic
    }
}
